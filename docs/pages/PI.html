<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>Persistent Images</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <link rel="stylesheet" href="../_static/theme.css">
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>

      
      <script src="../_static/theme-vendors.js"></script>
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Installation" href="Installation.html" />
  <link rel="prev" title="PersistentImages_Chemistry Documentation:" href="../index.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">Persistent Images for Chemistry</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../index.html#persistentimages-chemistry-documentation"
         class="nav-link  router-link-active">
         Tutorials
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#persistentimages-chemistry-documentation"
         class="nav-link ">
         Tools
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../index.html#persistentimages-chemistry-documentation"
         class="nav-link  router-link-active">
         Tutorials
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#persistentimages-chemistry-documentation"
         class="nav-link ">
         Tools
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#persistentimages-chemistry-documentation">Tutorials</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Persistent Images</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#what-is-topological-data-analysis" class="reference internal">What is Topological Data Analysis?</a></li>
                
                  <li class="toctree-l2"><a href="#generating-persistence-diagrams-and-persistence-diagrams" class="reference internal">Generating Persistence Diagrams and Persistence Diagrams</a></li>
                
              </ul>
            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#persistentimages-chemistry-documentation">Tools</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="Installation.html" class="reference internal ">Installation</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../API/API_index.html" class="reference internal ">API Reference</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="about.html" class="reference internal ">About</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>Persistent Images</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="../index.html"
       title="previous chapter">← PersistentImages_Chemistry Documentation:</a>
  </li>
  <li class="next">
    <a href="Installation.html"
       title="next chapter">Installation →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <div class="section" id="persistent-images">
<h1>Persistent Images<a class="headerlink" href="#persistent-images" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we present a method for molecular representation
that utilizes persistence homology to summarize a molecule’s
homological parts into a stable, machine-readable vector. This
chemical representation is called a persistence image, a tool of
persistence homology.</p>
<div class="section" id="what-is-topological-data-analysis">
<h2>What is Topological Data Analysis?<a class="headerlink" href="#what-is-topological-data-analysis" title="Permalink to this headline">¶</a></h2>
<p>Topology is a branch of mathematics that analyzes the shape and
important characteristics of an object. In topological data analysis
(TDA), we apply these techniques to the shape and important
characteristics of a data set. One such technique is persistent
homology, which tracks the appearance and disappearance of homological
features such as connected components and holes. These features appear
in a topological descriptor called persistence diagrams (PD)
containing the evolution of the connected components and holes from
birth to death. A PD can then be converted to a finite-dimensional
version of itself called a persistence image (PI). We outline the steps
from molecular structure to PI in the next two sections.</p>
<div class="section" id="converting-molecular-structures-to-persistence-diagrams">
<h3>Converting Molecular Structures to Persistence Diagrams<a class="headerlink" href="#converting-molecular-structures-to-persistence-diagrams" title="Permalink to this headline">¶</a></h3>
<p>We first produce a PD. In this case, we consider a chemical molecule
represented in the xyz plane where each point represents an atom.
We superimposed spheres of increasing radius centered at each atom.
As these spheres incrementally increase, they begin to intersect with
each other creating connected components and holes. Connected
components and holes represent the interatomic distances as well as
molecular attributes such as rings and groups respectively.</p>
<img alt="../_images/anisole_growing_radius_full.png" src="../_images/anisole_growing_radius_full.png" />
<p>In the figure above, we see the process by which a persistence diagram
is generated for the molecule anisole.</p>
<p><strong>(a)</strong> The atoms of anisole are
placed in the xyz plane (top) and each connected component is born at
time birth=0 as represented by the vertical orange lines (middle),
which has a corresponding PD (bottom).</p>
<p><strong>(b)</strong> As the radius of each sphere
superimposed on each atom doubles, we see all connected components have
persisted, which is represented by the lengthened orange lines (middle)
and the heightened persistence of each point in the PD (bottom).</p>
<p><strong>(c)</strong>
Again, the radii are increased; however, this time some radii intersect
(top). This signifies the death of as many connected components as there
are intersections, finalizing those points in the PD as well as the
birth of a hole generated by 6 carbon atoms of the phenyl group
represented by the blue line (middle) and blue triangle (bottom).</p>
<p><strong>(d)</strong>
More connected components die as the increasing radii intersect while
the hole still persists.</p>
<p><strong>(e)</strong> A second hole is created by the interaction
between the methoxyl group and two carbons of the phenyl group (top).
This hole as well as the previous hole die, leaving just one connected
component (middle) that will never die as it has nothing left to
intersect with. This last connected component is never represented in
the PD.</p>
</div>
<div class="section" id="converting-persistence-diagrams-to-persistent-images">
<h3>Converting Persistence Diagrams to Persistent Images<a class="headerlink" href="#converting-persistence-diagrams-to-persistent-images" title="Permalink to this headline">¶</a></h3>
<p>Now that we have converted molecules to PDs, we look to create vectorized, machine-readable persistence images. We do this by placing a Gaussian kernel on each persistence point in the PD. This, along with a variable, weighing function, which gives us control over what persistence points we want to give more significance, creates a pixelized version of our PD. The multiplicity of each atom in our molecule is represented by the intensity of the pixels. This surface is then transferred to pixel values that encode the persistence surface. This method yields variability issues as it is possible for two molecules with the same geometries to yield the same PIs. To mitigate this, we describe the variance of the gaussian kernel with pairwise electronegativity differences of the atoms.</p>
<img alt="../_images/whole_PI_diagram.png" src="../_images/whole_PI_diagram.png" />
<p>In the figure above, <strong>(a)</strong> we take the PD that we generated from
Figure 1 and compute the PIs for its <strong>(b)</strong> connected components and
<strong>(c)</strong> holes. Additionally, The PIs of <strong>(d)</strong> HBr and <strong>(e)</strong> F2 without
incorporating the electronegativity differences are shown by <strong>(f)</strong>
and <strong>(g)</strong> respectively. However, by factoring in the pairwise
electronegativity differences for HBr in <strong>(h)</strong> and F2 in <strong>(i)</strong> we
create distinctive PIs.</p>
</div>
</div>
<div class="section" id="generating-persistence-diagrams-and-persistence-diagrams">
<h2>Generating Persistence Diagrams and Persistence Diagrams<a class="headerlink" href="#generating-persistence-diagrams-and-persistence-diagrams" title="Permalink to this headline">¶</a></h2>
<div class="section" id="obtaining-data">
<h3>Obtaining data<a class="headerlink" href="#obtaining-data" title="Permalink to this headline">¶</a></h3>
<p>First, you need to obtain data to use as input for the generation of the PD and PI.
This library includes some preloaded data in the <em>babel</em> folder, and we will
use this data here as an example. This folder contains x, y, and z coordinates
for different compounds. In this example, we will load in data for a pyridine
molecule.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Element_PI</span> <span class="kn">import</span> <span class="n">PersDiagram</span>
<span class="kn">from</span> <span class="nn">Element_PI</span> <span class="kn">import</span> <span class="n">VariancePersist</span>

<span class="n">chem_data</span> <span class="o">=</span> <span class="s1">&#39;babel/1.xyz&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-hyperparameters">
<h3>Setting Hyperparameters<a class="headerlink" href="#setting-hyperparameters" title="Permalink to this headline">¶</a></h3>
<p>First, we’ll set the hyperparameter for our PD. The hyperparameter for
the PD-generating function, <code class="docutils literal notranslate"><span class="pre">PersDiagram</span></code> are described below.</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Lifetime</span></code> := Boolean value</dt><dd><ul class="simple">
<li><p>If you want to plot birth vs death on the PD, <code class="docutils literal notranslate"><span class="pre">Lifetime</span> <span class="pre">=</span> <span class="pre">False</span></code></p></li>
<li><p>If you want to plot birth vs persistence on the PD, <code class="docutils literal notranslate"><span class="pre">Lifetime</span> <span class="pre">=</span> <span class="pre">True</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<p>Next, we’ll need to set the hyperparameters for our PI. The arguments and hyperparameters for
the PI-generating function, <code class="docutils literal notranslate"><span class="pre">VariancePersist</span></code> are described below.</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">pixelx</span></code>, <code class="docutils literal notranslate"><span class="pre">pixely</span></code> := numeric values</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>These arguments correspond to the resolution of image</dt><dd><ul>
<li><p>How dense do you want your grid on the PI to be?</p></li>
<li><p>This is equivalent to the size of your output vector</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">myspread</span></code> := numeric value</dt><dd><ul class="simple">
<li><p>This argument specifies your variance for the Gaussian kernel</p></li>
<li><p>Higher <code class="docutils literal notranslate"><span class="pre">myspread</span></code> value accounts for more uncertainty in the PI</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">myspecs</span></code> := dictionary</dt><dd><ul class="simple">
<li><p>Form: <code class="docutils literal notranslate"><span class="pre">{&quot;maxBD&quot;:&lt;numeric</span> <span class="pre">value&gt;,</span> <span class="pre">&quot;minBD&quot;:&lt;numeric</span> <span class="pre">value&gt;}</span></code></p></li>
<li><p>The input for this argument must be specified in this form</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">showplot</span></code> := Boolean value</dt><dd><ul class="simple">
<li><p>If you want to output the plot of your PI, <code class="docutils literal notranslate"><span class="pre">showplot</span> <span class="pre">=</span> <span class="pre">True</span></code></p></li>
<li><p>If you want output suppressed, <code class="docutils literal notranslate"><span class="pre">showplot</span> <span class="pre">=</span> <span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="running-the-functions">
<h3>Running the Functions<a class="headerlink" href="#running-the-functions" title="Permalink to this headline">¶</a></h3>
<p>An example of generating a PD is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PersDiagram</span><span class="p">(</span><span class="s1">&#39;babel/1.xyz, lifetime = False)</span>
</pre></div>
</div>
<p>Here is our output plot for this example:</p>
<img alt="../_images/persistence_diagram_example.png" src="../_images/persistence_diagram_example.png" />
<p>An example of generating a PI is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VariancePersist</span><span class="p">(</span><span class="n">Filename</span> <span class="o">=</span> <span class="s1">&#39;babel/1.xyz&#39;</span><span class="p">,</span> <span class="n">pixelx</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">pixely</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">myspread</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span> <span class="n">myspecs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;maxBD&quot;</span><span class="p">:</span><span class="mf">2.5</span><span class="p">,</span> <span class="s2">&quot;minBD&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">showplot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is our output plot for this example:</p>
<img alt="../_images/PI_example_variancepersist1.png" src="../_images/PI_example_variancepersist1.png" />
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="../index.html"
       title="previous chapter">← PersistentImages_Chemistry Documentation:</a>
  </li>
  <li class="next">
    <a href="Installation.html"
       title="next chapter">Installation →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2020, Jacob Townsend, Cassie P. Micucci, John H. Hymel, Vasileios Maroulas, Konstantinos D. Vogiatzis.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.2 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>